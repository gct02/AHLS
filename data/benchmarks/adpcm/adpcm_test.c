#include <stdio.h>
#include "adpcm.h"

const int in_data[SIZE] = {
    0x44, 0x44, 0x44, 0x44, 0x44,
    0x44, 0x44, 0x44, 0x44, 0x44,
    0x44, 0x44, 0x44, 0x44, 0x44,
    0x44, 0x44, 0x43, 0x43, 0x43,
    0x43, 0x43, 0x43, 0x43, 0x42,
    0x42, 0x42, 0x42, 0x42, 0x42,
    0x41, 0x41, 0x41, 0x41, 0x41,
    0x40, 0x40, 0x40, 0x40, 0x40,
    0x40, 0x40, 0x40, 0x3f, 0x3f,
    0x3f, 0x3f, 0x3f, 0x3e, 0x3e,
    0x3e, 0x3e, 0x3e, 0x3e, 0x3d,
    0x3d, 0x3d, 0x3d, 0x3d, 0x3d,
    0x3c, 0x3c, 0x3c, 0x3c, 0x3c,
    0x3c, 0x3c, 0x3c, 0x3c, 0x3b,
    0x3b, 0x3b, 0x3b, 0x3b, 0x3b,
    0x3b, 0x3b, 0x3b, 0x3b, 0x3b,
    0x3b, 0x3b, 0x3b, 0x3b, 0x3b,
    0x3b, 0x3b, 0x3b, 0x3b, 0x3b,
    0x3b, 0x3b, 0x3c, 0x3c, 0x3c,
    0x3c, 0x3c, 0x3c, 0x3c, 0x3c
};
const int encoded_test[SIZE/2] = {
    0xfd, 0xde, 0x77, 0xba, 0xf2, 
    0x90, 0x20, 0xa0, 0xec, 0xed, 
    0xef, 0xf1, 0xf3, 0xf4, 0xf5, 
    0xf5, 0xf5, 0xf5, 0xf6, 0xf6, 
    0xf6, 0xf7, 0xf8, 0xf7, 0xf8, 
    0xf7, 0xf9, 0xf8, 0xf7, 0xf9, 
    0xf8, 0xf8, 0xf6, 0xf8, 0xf8, 
    0xf7, 0xf9, 0xf9, 0xf9, 0xf8, 
    0xf7, 0xfa, 0xf8, 0xf8, 0xf7, 
    0xfb, 0xfa, 0xf9, 0xf8, 0xf8
};
const int decoded_test[SIZE] = {
    0, 0xffffffff, 0xffffffff, 0, 0, 
    0xffffffff, 0, 0, 0xffffffff, 0xffffffff, 
    0, 0, 0x1, 0x1, 0, 
    0xfffffffe, 0xffffffff, 0xfffffffe, 0, 0xfffffffc, 
    0x1, 0x1, 0x1, 0xfffffffb, 0x2, 
    0x2, 0x3, 0xb, 0x14, 0x14, 
    0x16, 0x18, 0x20, 0x21, 0x26, 
    0x27, 0x2e, 0x2f, 0x33, 0x32, 
    0x35, 0x33, 0x36, 0x34, 0x37, 
    0x34, 0x37, 0x35, 0x38, 0x36, 
    0x39, 0x38, 0x3b, 0x3a, 0x3f, 
    0x3f, 0x40, 0x3a, 0x3d, 0x3e, 
    0x41, 0x3c, 0x3e, 0x3f, 0x42, 
    0x3e, 0x3b, 0x37, 0x3b, 0x3e, 
    0x41, 0x3b, 0x3b, 0x3a, 0x3b, 
    0x36, 0x39, 0x3b, 0x3f, 0x3c, 
    0x3b, 0x37, 0x3b, 0x3d, 0x41, 
    0x3d, 0x3e, 0x3c, 0x3e, 0x3b, 
    0x3a, 0x37, 0x3b, 0x3e, 0x41, 
    0x3c, 0x3b, 0x39, 0x3a, 0x36
};

int main() {
    int encoded[SIZE/2], decoded[SIZE];
    int i;
    int wrong_values = 0;
    
    adpcm_main(in_data, encoded, decoded);

    printf("Encoded: ");
    for (i = 0; i < SIZE/2; i++) {
        printf("%d ", encoded[i]);
        if (encoded[i] != encoded_test[i]) {
            wrong_values += 1;
        }
    }
    printf("\n");

    printf("Decoded: ");
    for (i = 0; i < SIZE; i++) {
        printf("%d ", decoded[i]);
        if (decoded[i] != decoded_test[i]) {
            wrong_values += 1;
        }
    }

    printf("\nWrong values: %d\n", wrong_values);
    return wrong_values;
}