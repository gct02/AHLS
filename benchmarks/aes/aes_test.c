#include <stdio.h>
#include "aes.h"

int main()
{
    int statemt[IN_SIZE] = {
        0x32, 0x43, 0xf6, 0xa8, 0x88, 0x5a, 0x30, 0x8d, 
        0x31, 0x31, 0x98, 0xa2, 0xe0, 0x37, 0x07, 0x34
    };
    int key[IN_SIZE] = {
        0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 
        0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c
    };
    const int out_dec_statemt[OUT_SIZE] = {
        0x32, 0x43, 0xf6, 0xa8, 0x88, 0x5a, 0x30, 0x8d, 
        0x31, 0x31, 0x98, 0xa2, 0xe0, 0x37, 0x7, 0x34
    };
    int wrong_values = 0;

    aes_main(statemt, key);

    for (int i = 0; i < OUT_SIZE; i++)
    {
        if (statemt[i] != out_dec_statemt[i])
        {
            printf("out_dec_statemt[%d] = %d\n", i, out_dec_statemt[i]);
            printf("statemt[%d] = %d\n", i, statemt[i]);
            wrong_values += 1;
        }
    }

    return wrong_values;
}